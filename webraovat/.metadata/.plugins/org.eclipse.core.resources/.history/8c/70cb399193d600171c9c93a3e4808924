(function(){
	'use strict';
	angular
		.module('webraovatApp')
		.controller('UserController', UserController);
	UserController.$inject = ['$http', '$state'];
	function UserController($http, $state){
		var vm = this;
		vm.users = [];
		vm.alerts = [];
		vm.load = load;
		
		vm.load();
		
		function load() {
			showAlert();
			$http({
				url : "UserController?action=getall",
				method: "POST",
			}).then(function(response) {
				vm.users = response.data;
	        }, function(response) {
	            console.log(response);
	        });
		}
		
		vm.showUser = function(id) {
			$state.go("user-create", {id: id});
		}
		
		function showAlert() {
			$scope.$on('update-success', function(){
				var alert = { type: 'success', msg: 'Cập nhật user thành công!'};
				vm.alerts.push(alert);
			});
		}
		
		vm.closeAlert = function(index) {
		    vm.alerts.splice(index, 1);
		};
	}
	
})();